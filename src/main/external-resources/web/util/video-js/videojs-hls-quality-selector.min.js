/**
 * @eban5/videojs-hls-quality-selector
 * @version 1.1.5
 * @copyright 2022 Chris Boustead (chris@forgemotion.com), Esteban Amas (estebanamas@gmail.com), 
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):t.videojsHlsQualitySelector=e(t.videojs)}(this,function(o){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){if(t)return!e||"object"!=typeof e&&"function"!=typeof e?t:e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}var e=o.getComponent("MenuButton"),i=o.getComponent("Menu"),s=o.getComponent("Component"),a=o.dom;t(h,n=e),h.prototype.createItems=function(){return[]},h.prototype.createMenu=function(){var t,e=new i(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title&&(t=a.createEl("li",{className:"vjs-menu-title",innerHTML:"string"!=typeof(t=this.options_.title)?t:t.charAt(0).toUpperCase()+t.slice(1),tabIndex:-1}),t=new s(this.player_,{el:t}),this.hideThreshold_+=1,e.addItem(t)),this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)e.addItem(this.items[n]);return e};var n,c=h;function h(t){return l(this,h),u(this,n.call(this,t,{title:t.localize("Quality"),name:"QualityButton"}))}var y,e=o.getComponent("MenuItem"),p=(t(f,y=e),f.prototype.handleClick=function(){for(var t=0;t<this.qualityButton.items.length;++t)this.qualityButton.items[t].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)},f);function f(t,e,n,i){l(this,f);t=u(this,y.call(this,t,{label:e.label,selectable:!0,selected:e.selected||!1}));return t.item=e,t.qualityButton=n,t.plugin=i,t}var d={},e=o.registerPlugin||o.plugin,v=(m.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).vhs},m.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this,this.config.sortAscending,this.config.autoPlacement))},m.prototype.createQualityButton=function(){var t=this.player,e=(this._qualityButton=new c(t),t.controlBar.children().length-2),t=t.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||e);t.addClass("vjs-quality-selector"),this.config.displayCurrentQuality?this.setButtonInnerText("auto"):(e=" "+(this.config.vjsIconClass||"vjs-icon-hd"),t.menuButton_.$(".vjs-icon-placeholder").className+=e),t.removeClass("vjs-hidden")},m.prototype.setButtonInnerText=function(t){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=t},m.prototype.getQualityMenuItem=function(t){var e=this.player;return new p(e,t,this._qualityButton,this)},m.prototype.onAddQualityLevel=function(){for(var n=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"bottom",i=this.player,o=i.qualityLevels().levels_||[],l=[],u=this.getQualityMenuItem.call(this,{label:i.localize("Auto"),value:"auto",selected:!0}),s=0;s<o.length;++s)!function(e){if(!o[e].height)return;var t;l.filter(function(t){return t.item&&t.item.value===o[e].height}).length||(t=n.getQualityMenuItem.call(n,{label:o[e].height+"p",value:o[e].height}),l.push(t))}(s);t?l.sort(function(t,e){return"object"!==(void 0===t?"undefined":r(t))||"object"!==(void 0===e?"undefined":r(e))?-1:t.item.value-e.item.value}):l.sort(function(t,e){return"object"!==(void 0===t?"undefined":r(t))||"object"!==(void 0===e?"undefined":r(e))?-1:e.item.value-t.item.value}),this._qualityButton&&(this._qualityButton.createItems=function(){return"top"===e?[u].concat(l):[].concat(l,[u])},this._qualityButton.update())},m.prototype.setQuality=function(t){var e=this.player.qualityLevels();this._currentQuality=t,this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===t?t:t+"p");for(var n=0;n<e.length;++n){var i=e[n];i.enabled=i.height===t||"auto"===t}this._qualityButton.unpressButton()},m.prototype.getCurrentQuality=function(){return this._currentQuality||"auto"},m);function m(t,e){l(this,m),this.player=t,this.config=e,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}function g(n){var i=this;this.ready(function(){var t,e;t=i,e=o.mergeOptions(d,n),t.addClass("vjs-hls-quality-selector"),t.hlsQualitySelector=new v(t,e)})}return e("hlsQualitySelector",g),g.VERSION="1.1.5",g});